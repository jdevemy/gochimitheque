| {{define "CONTENT"}}
    .row
        .col-sm-4.offset-sm-4
            #filter-product

    form#storage
        input#index(type='hidden', name='index', value='')
        input#product_id(type='hidden', name='product_id', value='')

        .form-group.row
            .col-sm-12
                | {{$label := "store location"}} {{$name := "storelocation"}}
                +select
        .form-group.row
            .col-sm-12
                | {{$label := "nb items"}} {{$name := "storage_nbitem"}} {{$step := "1"}} {{$min := "1"}} {{$max := "30"}} {{$value := "1"}}
                +inputnumber
        .form-group.row
            .col-sm-6
                | {{$label := "quantity"}} {{$name := "storage_quantity"}} {{$step := "any"}} {{$min := "1"}} {{$max := "10000000"}} {{$value := ""}}
                +inputnumber
            .col-sm-6
                | {{$label := "unit"}} {{$name := "unit"}}
                +select 
        .form-group.row
            .col-sm-12
                | {{$label := "supplier"}} {{$name := "supplier"}}
                +select
        .form-group.row
            .col-sm-12
                | {{$label := "barecode"}} {{$name := "storage_barecode"}}
                +inputtext
        .form-group.row
            .col-sm-12
                | {{$label := "comment"}} {{$name := "storage_comment"}}
                +inputtext        

    button#save.btn.btn-primary(type='button', onclick='saveStorage()') save changes
| {{end}}
| {{define "CONTENTJS"}}
| {{template "COMMONCONTENTJS"}}
    script.

       $( document ).ready(function() {           

            //
            // retrieving product
            //
            var urlParams = new URLSearchParams(window.location.search);
            p = urlParams.get("product");
            if (p === null) {
                window.location.replace("/v/products");
            }
            // getting the product
            $.ajax({
                url: "/products/" + p,
                method: "GET",
            }).done(function(data, textStatus, jqXHR) {
                $("input#product_id").val(p);
                $("#filter-product").html("<div class='card'><div class='card-body'>" + data.name.name_label + " (" + data.casnumber.casnumber_label + ")</div></div>")
            }).fail(function(jqXHR, textStatus, errorThrown) {
                handleHTTPError(jqXHR.statusText, jqXHR.status)
            });

        });

| {{end}}